{% load bootstrap3 %}
{% load widget_tweaks %}
{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <title>Create a new contest</title>

        {% bootstrap_css %}
        {% bootstrap_javascript %}

        <link rel="stylesheet" href="{% static 'style.css' %}">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

        {{ form.media }}

        <style>
            li {list-style-type: none;}
            .btn-margin {margin: 5px;}
        </style>
    </head>

    <body style="padding-left: 30px;">

        {% include 'contests/navbar.html' %}

        <div class="progress progress-striped active">
            <div class="progress-bar" style="width: 45%"></div>
        </div>

        <div class="col-lg-10">
            <div class="well bs-component">
                <form class="form-horizontal" id="load_contest_template" method="post"
                      action="{% url 'contests:load_template' %}">
                    <fieldset>
                        <legend>Default Templates</legend>

                        {% csrf_token %}

                        <div class="form-group">
                            <div class="col-lg-10">
                                <select class="form-control" name="selected_template">
                                    {% for field in templates %}
                                    <option value="{{ field.id }}">{{ field.title }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>

                        <div class="col-lg-10 col-lg-offset-2">
                            {% bootstrap_button "Load Template" button_type="submit" name="submit" button_class="btn btn-primary" %}
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>

        <div class="col-lg-10">
            <div class="well bs-component">
                <form class="form-horizontal" id="create_contest" method="post"
                      action="{% url 'contests:create' %}" enctype="multipart/form-data">
                    <fieldset>
                        <legend>Contest Creation</legend>

                        {% csrf_token %}

                        {% for field in form %}
                            {% bootstrap_field field layout='horizontal' %}
                        {% endfor %}
                    </fieldset>

                    <fieldset>
                        <legend>Individual Problems</legend>

                        {{ qa_formset.management_form }}

                        <div class="qa-formset">
                            {% bootstrap_formset qa_formset layout='horizontal' %}
                        </div>

                        <div class="col-lg-10 col-lg-offset-2">
                            {% bootstrap_button "Create Contest" button_type="submit" name="submit" button_class="btn btn-primary" %}
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>

        <script type="text/javascript">
            $(document).ready(function() {
                    $(function () {
                        $('#id_contest_length_pickers:has(input:not([readonly],[disabled]))').datetimepicker({"format": "HH:mm"});
                    });
                    $(function () {
                        $('#id_time_penalty_pickers:has(input:not([readonly],[disabled]))').datetimepicker({"format": "mm"});
                    });
                });
        </script>

        <!--<script type="text/javascript">
            (function(window) {
                var callback = function() {
                    $(function(){$("#id_contest_length_pickers:has(input:not([readonly],[disabled]))").datetimepicker({"language": "en-us", "format": "HH:MM"});});
                };
                if(window.addEventListener)
                    window.addEventListener("load", callback, false);
                else if (window.attachEvent)
                    window.attachEvent("onload", callback);
                else window.onload = callback;
            })(window);
        </script>-->

        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js"></script>
        {% load static %}
        <script src="{% static 'js/jquery.formset.js' %}"></script>
        <script>
            $('.qa-formset').formset({
                addText: 'add question',
                deleteText: 'delete question',
                addCssClass: 'add-row btn btn-primary btn-sm btn-margin',
                deleteCssClass: 'delete-row btn btn-primary btn-sm btn-margin'
            });
        </script>

        <script type='text/javascript'>
            $('#id_autojudge_enabled').click(function() {
                if($('#id_autojudge_enabled').prop('checked') == true) {
                    $('#id_autojudge_review').prop('disabled', false);
                } else {
                    $('#id_autojudge_review').prop('disabled', true);
                }
            });
        </script>
    </body>
</html>
